<%= labelled_form_for @gitlab_merge_request,
           :as => :merge_request,
           :url => { :controller => 'merge_request', :action => 'edit', :id => @project },
           :remote => true,
           :method => 'post' do |f| %>


<fieldset class="box tabular">
<% if flash[:notice]  %>
      <div class="notice" style="margin-left: 45%; margin-right: 45%"><%= flash[:notice] %></div>
  <% end %>
  <% if @gitlab_merge_request.errors.any? %>
      <div id="error_explanation">
        <h2><%= pluralize(@gitlab_merge_request.errors.count, "error") %> prohibited the settings from being saved:</h2>
        <ul>
          <% @gitlab_merge_request.errors.full_messages.each do |msg| %>
              <li><%= msg %></li>
          <% end %>
        </ul>
      </div>
  <% end %>
  <div id="merge_request_project_param" <% if @gitlab_merge_request.use_parent_settings %>style="display: none;"<% end%>>
    <% if @project.child? %>
    <p><%= f.check_box :use_parent_settings %></p>
<% else %>

        <%# f.hidden_field :use_parent_settings, :value => @gitlab_merge_request.use_parent_settings  %>
<% end %>


        <p><%= f.text_field :gitlab_url, :size => 60, :required => false %>


        <p><%= f.text_field :project_name, :size => 30, :required => false %></p>

        <p><%= f.text_field :assignee_id, :size => 30, :required => false %></p>
    
        <p><%= f.text_field :milestone_id, :size => 30, :required => false %></p>
    
        <p><%= f.text_field :source, :size => 30, :required => false %></p>
    
        <p><%= f.text_field :target, :size => 30, :required => false %></p>
    </div>

    <div><%= l(:gitlab_merge_request_project_settings_help) %></div>

    <div><%= submit_tag(l(:button_save)) %></div>
</fieldset>

<% end %>

<script type="text/javascript">
$('#merge_request_use_parent_settings').on('change', function(){
    if ($(this).is(':checked')) {
        $('#merge_request_project_param').fadeOut();
    } else {
        $('#merge_request_project_param').fadeIn();
    }
});
</script>